### 反射：写一个“框架”，不能改变该类的任何代码的前提下，可以帮我们创建任意类，并执行其中任意方法
![[Pasted image 20240408112234.png]]
**思路**
- 将要创建对象的类和调用的方法写在配置文件中作为输入
- 读取配置文件的信息，获得全类名，和方法名
- 根据全类名-->指定类的Class对象
- 根据class对象获得构造方法，创建对象
- 根据class对象获得调用方法，结合上面的对象，invoke方法
###### 代码
demo.properties
```
className=edu.hebut.domain.Person  
method=sleep
```
Person类
```java
public class Person {  
    public void sleep(){  
        System.out.println("sleep...");  
    }  
}
```
Reflect类
```java
public class Reflect {  
    public static void main(String[] args) throws Exception {  
        //解析配置文件，获取需要创建对象的类名和需要调用的方法  
        Properties properties=new Properties();  
        properties.load(new FileInputStream("C:\\Users\\李嘉成\\Desktop\\javaStudy\\javaweb-code\\day01testandclass\\src\\demo.properties"));  
  
        String className = properties.getProperty("className");  
        String methodName = properties.getProperty("method");  
        //根据类名，获取类对应的class类  
        Class cls = Class.forName(className);  
        //获取构造方法，并创建对象  
        Constructor constructor = cls.getConstructor();  
        Object o = constructor.newInstance();  
        //获取方法  
        Method method = cls.getMethod(methodName);  
        method.invoke(o);  
    }  
}
```
运行结果
`sleep...`

### 注解：使用注解完成被注解标记的方法才被测试的框架
### 注解：将书写的类转成api文档

### 实现JDBC的工具类，实现两个功能，一是异常处理，二是注册驱动，获取连接对象（通过读取properties实现）。
**思路**
功能一：pulic static void close(){}
- 通过传入需要释放资源的参数进行释放资源，对于DQL有ResultSet的返回值，而DML和DDL没有，所以需要释放的参数不统一，共有的是Connection和Statement对象-->方法重写
功能二：public static getConnection()
- 直接return DriverManager(url,user,password);
- 对于上述三个参数的获取，直接采用解析properties文档实现。
- 定义上述变量的静态全局变量，通过静态代码块实现 注册驱动和变量赋值。
jdbc.properties
```
url=jdbc:mysql://localhost:3306/db5  
user=root  
password=123456  
driver=com.mysql.cj.jdbc.Driver
```
JDBC.Utils
```java
  
public class JDBCUtils {  
    private static String driver;  
    private static String url;  
    private static String password;  
    private static String user;  
    static {  
        try {  
            Properties properties = new Properties();  
            properties.load(new FileInputStream("C:\\Users\\李嘉成\\Desktop\\javaStudy\\javaweb-code\\day04_jdbc\\src\\jdbc.properties"));  
            url= properties.getProperty("url");  
            password=properties.getProperty("password");  
            user=properties.getProperty("user") ;  
            driver=properties.getProperty("driver");  
            Class.forName(driver);  
  
        } catch (IOException e) {  
            throw new RuntimeException(e);  
        } catch (ClassNotFoundException e) {  
            throw new RuntimeException(e);  
        }  
    }  
    public static Connection getConnection(){  
        try {  
            return DriverManager.getConnection(url,user,password);  
        } catch (SQLException e) {  
            throw new RuntimeException(e);  
        }  
    }  
  
  
    public static void close(Connection conn, Statement statement){  
        if(statement!=null){  
            try {  
                statement.close();  
            } catch (SQLException e) {  
                throw new RuntimeException(e);  
            }  
        }  
        if(conn!=null){  
            try {  
                conn.close();  
            } catch (SQLException e) {  
                throw new RuntimeException(e);  
            }  
        }  
    }  
    public static void close(Connection conn, Statement statement, ResultSet resultSet){  
        if(resultSet!=null){  
            try {  
                resultSet.close();  
            } catch (SQLException e) {  
                throw new RuntimeException(e);  
            }  
        }  
        if(statement!=null){  
            try {  
                statement.close();  
            } catch (SQLException e) {  
                throw new RuntimeException(e);  
            }  
        }  
        if(conn!=null){  
            try {  
                conn.close();  
            } catch (SQLException e) {  
                throw new RuntimeException(e);  
            }  
        }  
    }  
}
```
对util包的使用的类，实现的功能是读取姓名，收入，id
```java
public class JdbcDemo3 {  
  
    public static void main(String[] args) {  
        Connection connection=null;  
        Statement statement=null;  
        try {  
            connection = JDBCUtils.getConnection();  
            String sql="insert into area values(null,'中国'),(null,'美国')";  
            statement = connection.createStatement();  
            int i = statement.executeUpdate(sql);  
            System.out.println(i);  
  
        } catch (SQLException e) {  
            throw new RuntimeException(e);  
        }finally {  
            JDBCUtils.close(connection,statement);  
        }  
  
    }  
}
```
### 实现用户登录功能
**思路：**
- 创建pulic boolean login(string user,string password);函数
- 函数中查询user数据库中是否含有这条记录，从而判定是否登录成功；
**问题：**-->解决方案PreparedStatement替代Statement
```java
`String sql="select * from user where username='"+username+"'and password='"+password+"'";  `
```
这个语句单纯是字符串的拼接，所以username=sjfoiaj； password=a' or 'a'='a; 那么
搜索出全部结果，会显示登录密码成功。
```java
string sql="select * FROM user where username=='sfjaoj' and `password`='sfjiaf' or 'a'='a';"
```
![[Pasted image 20240410222306.png]]
**代码：** 
```java
public class JdbcDemo4 {  
    public static void main(String[] args) {  
        Scanner sc=new Scanner(System.in);  
        System.out.println("请输入用户名：");  
        String username = sc.nextLine();  
        System.out.println("请输入密码：");  
        String password=sc.nextLine();  
        System.out.println(new JdbcDemo4().login(username,password)?"登录成功":"用户名或密码错误");  
    }  
    public boolean login(String username,String password) {  
        Connection connection=null;  
        Statement statement=null;  
        ResultSet resultSet=null;  
        try {  
            connection=JDBCUtils.getConnection();  
            statement=connection.createStatement();  
            String sql="select * from user where username='"+username+"'and password='"+password+"'";  
            resultSet = statement.executeQuery(sql);  
            return resultSet.next();  
        } catch (SQLException e) {  
            throw new RuntimeException(e);  
        }finally {  
            JDBCUtils.close(connection,statement,resultSet);  
        }  
    }  
}
```
![[Pasted image 20240410180320.png]]

