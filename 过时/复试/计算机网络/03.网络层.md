功能：
- 路由选择与分组转发
- 异构网络互联
- 拥塞控制：开环控制，闭环控制

IPv4分组
**结构：** 从功能出发看结构：
- 有IPv4和IPv6两个版本，所以得有版本号。
- 首部有固定部分和可变部分，因此得标识首部长度，有首部长度，单位4B。4bit最大15，所以首部最长是60B，且4B整数倍。
- MTU的限制，部分网段需要分片。分片需要标识标志片偏移。分片合起来的工作在接收方完成，通过标识表征同一个IP数据报，通过片偏移表征顺序（8B,数据部分字节是0），通过标志表征结束和继续（是否还有其他分片）。
- 要避免ip数据报一直在网上兜圈子的可能性，所以有TTL，生存时间（都我这，减1后判断）。
- 要标识数据部分是TCP还是UDP所以得有协议字段。6标识TCP，17标识UDP。
- 要表示发送地址和接收地址，所以有源ip和目的ip。 
![[Pasted image 20250312101633.png]]

网络层的运行原理，三个视角：
- 发送方
发送方在填写ip数据报的源地址和目的地址，判断目的地址是否为与自己的地址在同一网络，若是则本网络中转发，若不是则发往默认ip地址。
这里有细节，如如何判断目的地址和与自己是否在同一网络？
本质上，连接在路由器一个端口的一串主机构成同一个网络。
在初始的ip地址分类中，分为了ABCDE五类，每种类别占用的网络号的位数不同但固定。根据ip地址的第一个字段就能知道属于哪儿个类别。每个路由器的一个端口就必须占用一个网络号。因此，判断同一个网络，通过第一个字段判断类别进而判断网络位数，然后再比较网络号。
在上面的语境中，申请一个网络号，只能有个网络，但是在不同部门之间有网络隔离的需求。


和谁交换？
什么时候交换？
交换什么信息？
怎么修改信息的？